"use strict";(self.webpackChunk_playcanvas_blog=self.webpackChunk_playcanvas_blog||[]).push([[43845],{32038:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var o=n(74848),s=n(28453);const i={authors:"nathan",slug:"playhack-december-collecting-presents",title:"PLAYHACK December - Collecting Presents"},a=void 0,r={permalink:"/playhack-december-collecting-presents",editUrl:"https://github.com/playcanvas/blog/tree/main/blog/2014-12-22-playhack-december-collecting-presents.md",source:"@site/blog/2014-12-22-playhack-december-collecting-presents.md",title:"PLAYHACK December - Collecting Presents",description:"**PLAYHACK** is our fun monthly game building session. Throughout the month I\u2019ll be posting tips and tricks to help you get a game made by the end of the month.\xa0Don\u2019t forget, these are just examples. You can make **any** game you like. Read more about this month\u2019s PLAYHACK.",date:"2014-12-22T00:00:00.000Z",tags:[],readingTime:5.94,hasTruncateMarker:!1,authors:[{name:"Nathan",key:"nathan"}],frontMatter:{authors:"nathan",slug:"playhack-december-collecting-presents",title:"PLAYHACK December - Collecting Presents"},unlisted:!1,prevItem:{title:"PlayCanvas in 2014: A Year In Review",permalink:"/playcanvas-in-2014-a-year-in-review"},nextItem:{title:"PLAYHACK December - Creating Presents",permalink:"/playhack-december-creating-presents"}},l={authorsImageUrls:[void 0]},c=[{value:"Adding an Offscreen Trigger Volume",id:"adding-an-offscreen-trigger-volume",level:2},{value:"Setting up the present",id:"setting-up-the-present",level:2},{value:"Santa Trigger Volume",id:"santa-trigger-volume",level:2}];function h(e){const t={a:"a",code:"code",em:"em",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:(0,o.jsxs)(t.em,{children:[(0,o.jsx)(t.strong,{children:"PLAYHACK"})," is our fun monthly game building session. Throughout the month I\u2019ll be posting tips and tricks to help you get a game made by the end of the month.\xa0Don\u2019t forget, these are just examples. You can make ",(0,o.jsx)(t.strong,{children:"any"})," game you like. ",(0,o.jsx)(t.a,{href:"https://blog.playcanvas.com/playhack-december-jolly-santa/",children:"Read more"})," about this month\u2019s PLAYHACK."]})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"PLAYHACK Logo",src:n(6694).A+"",width:"603",height:"218"})}),"\n",(0,o.jsxs)(t.p,{children:["We'll be following on from ",(0,o.jsx)(t.a,{href:"https://blog.playcanvas.com/playhack-december-creating-presents/",children:"last time's tutorial"})," this time, so make sure you've followed that one before attempting this! As always, you can check out all the up to date code ",(0,o.jsx)(t.a,{href:"https://playcanvas.com/project/333523/overview/playhack_december",children:"in this project"}),"."]}),"\n",(0,o.jsx)("div",{className:"iframe-container",children:(0,o.jsx)("iframe",{loading:"lazy",src:"https://playcanv.as/b/MjlE6fOY/",title:"360 lookaround camera",webkitallowfullscreen:"true",mozallowfullscreen:"true",allow:"autoplay",allowfullscreen:"true",allowvr:"",scrolling:"no",frameborder:"0"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.em,{children:"Use W and S to move the sleigh."})}),"\n",(0,o.jsxs)(t.p,{children:["In this tutorial, we're going to do two things - delete the presents as they go off-screen, and find out when the presents collide with Santa. How are we going to do all this? The answer: ",(0,o.jsx)(t.strong,{children:"Trigger Volumes"}),"!"]}),"\n",(0,o.jsx)(t.h2,{id:"adding-an-offscreen-trigger-volume",children:"Adding an Offscreen Trigger Volume"}),"\n",(0,o.jsx)(t.p,{children:"At the moment, when presents go offscreen, they just keep going on and on forever and ever. We don't need the presents anymore after they've gone offscreen, so it doesn't hurt (and may even help) us if we delete them. So, we need a way to test when a present has left the screen. We can do that with a Trigger Volume placed just offscreen."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(10487).A+"",children:(0,o.jsx)(t.img,{alt:"DEC-PLAYHACK-TUT3-2",src:n(48501).A+"",width:"1462",height:"828"})})}),"\n",(0,o.jsxs)(t.p,{children:["You may be thinking - what is a trigger volume?! A trigger volume is simply an ",(0,o.jsx)(t.strong,{children:"entity with a collision component"})," added to it (but without a rigidbody - we'll get to that later). They allow us to test when rigidbodies enter and leave them - which is perfect for testing when a present goes off-screen."]}),"\n",(0,o.jsx)(t.p,{children:'So, to add the off-screen trigger volume, simply right click on\xa0"Santa" in the Pack Explorer and add a new Entity. I called mine "offscreen". Then, add a collision component to your new offscreen entity - a small blue cube should appear in the editor. Now, all we need to do is move it off-screen, and resize it so it catches all the presents. You can move it with the translate tool, and to make it big enough, you can edit the "half-extents" of the collision component until it covers the whole of the edge of the camera.'}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(36846).A+"",children:(0,o.jsx)(t.img,{alt:"DEC-PLAYHACK-TUT3-3",src:n(65612).A+"",width:"263",height:"287"})})}),"\n",(0,o.jsx)(t.p,{children:'Now, let\'s write\xa0some code to delete the presents that come off-screen. Add a script component to the offscreen entity, and add a new script - I called the script "offscreen.js" (creative name, I know).'}),"\n",(0,o.jsx)(t.p,{children:"Whenever a rigidbody enters the trigger volume, the collision component will fire an event that we can listen to. Or, in simple terms, we can tell the collision component to call a specific function any time it comes into contact with a rigidbody. Put the following code in the initialize function of your new script:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:"this.entity.collision.on('triggerenter', this.onTriggerEnter, this);\n"})}),"\n",(0,o.jsxs)(t.p,{children:['This tells our collision component that when the "',(0,o.jsx)(t.strong,{children:"triggerenter"}),'" event happens (i.e. something enters the trigger volume), call the function "',(0,o.jsx)(t.strong,{children:"onTriggerEnter"}),'", in the scope of ',(0,o.jsx)(t.strong,{children:"this"})," (so we have access to all our variables and functions).\xa0Let's write that function now:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:"onTriggerEnter: function (other) {\n    other.destroy();\n}\n"})}),"\n",(0,o.jsx)(t.p,{children:"Pretty simple huh? The onTriggerEnter function gets called with one argument, which is the entity it collided with. We simply destroy that entity, and it's gone!"}),"\n",(0,o.jsx)(t.h2,{id:"setting-up-the-present",children:"Setting up the present"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(21756).A+"",children:(0,o.jsx)(t.img,{alt:"DEC-PLAYHACK-TUT3-1",src:n(46398).A+"",width:"1464",height:"830"})})}),"\n",(0,o.jsxs)(t.p,{children:["If we run the game now though, the presents still won't get deleted even if they go off-screen!\xa0That's because trigger volumes only check for collisions with rigidbodies, so we'll need to add some more components to the present. We need to add a ",(0,o.jsx)(t.strong,{children:"collision"})," component and a\xa0",(0,o.jsx)(t.strong,{children:"kinematic\xa0rigidbody"})," component. Together, these will allow us to check when the present passes through our trigger volumes."]}),"\n",(0,o.jsxs)(t.p,{children:['So, add those components to the\xa0Gift. Make sure you change the "type" attribute of the rigidbody component to ',(0,o.jsx)(t.strong,{children:"Kinematic"})," - we don't want it to be Static, because then we couldn't move the presents, and we don't need it to be ",(0,o.jsx)(t.strong,{children:"Dynamic"})," because then our present would get affected by gravity and physics and we don't need that.\xa0",(0,o.jsx)(t.strong,{children:"Kinematic"})," allows us to move our present in code, but not have it affected by physics. You can fiddle around with the half extents of the collision box until it fits around the present too."]}),"\n",(0,o.jsx)(t.p,{children:"You'll also notice the collision box isn't centred on the present model. To fix this, you can removed the model component from Gift and add a model entity child instead, which you can then translate without affecting the position of the collision box."}),"\n",(0,o.jsx)(t.p,{children:"One last thing - it's very important that you uncheck the Enabled attribute of the Gift. If the original gift goes off-screen and\xa0collides with the off-screen Trigger Volume, it will get deleted, and we won't be able to make any copies of it. We can make sure that never happens by disabling\xa0the present - now the original present won't do anything, but it will still be there for us to clone and make more presents."}),"\n",(0,o.jsx)(t.p,{children:"If you test the game now, the presents should be getting deleted after they go off-screen! You can test that it's actually working by moving the\xa0off-screen Trigger Volume on-screen a bit - the presents should then disappear just before they go off-screen."}),"\n",(0,o.jsx)(t.h2,{id:"santa-trigger-volume",children:"Santa Trigger Volume"}),"\n",(0,o.jsx)(t.p,{children:"But the present going offscreen isn't the only thing we want to check for - we also need to check when it collides with Santa! Luckily, this is very similar to the offscreen trigger volume."}),"\n",(0,o.jsxs)(t.p,{children:["Like before, we need to add a collision component - so right click on Santa and add one. There's a clever thing we can do here: instead of messing around with the half-extends of the collision box, trying to get it to match Santa, we can simply tell the collision component to match the size and shape of the Santa Model. Change the type attribute of the collision component to ",(0,o.jsx)(t.strong,{children:"Mesh"}),", and select the Santa_sleigh model for the ",(0,o.jsx)(t.strong,{children:"Asset"}),". Now, the collision will only check for exactly the right size of Santa."]}),"\n",(0,o.jsx)(t.p,{children:"Wondering why we can't use a Mesh\xa0for the collision component of Gift? Checking for collisions between two\xa0Meshes is a lot more computationally expensive compared to comparing collisions with simple geometry. Therefore, checking for a collision between two Meshes isn't allowed, and since our present is basically a cube, we're using a cube for the collision volume of the present."}),"\n",(0,o.jsx)(t.p,{children:"Now we just need to add a small amount of code to Santa so we know when presents collide with him."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:"this.entity.collision.on('triggerenter', this.onTriggerEnter, this);\n"})}),"\n",(0,o.jsx)(t.p,{children:"Put that line in the santa_controller.js script - it does exactly the same thing as before. We're going to write a simple onTriggerEnter function for now, and actually write the functionality we want next time."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:'onTriggerEnter:function(other) {\n    if (other.name === "Gift") {\n        other.destroy();\n        // we\'ll be adding score incrementing and other stuff here...\n    }\n}\n'})}),"\n",(0,o.jsx)(t.p,{children:"All we're doing\xa0here at the moment is the same as the offscreen trigger volume - destroying the present when it comes into contact with Santa."}),"\n",(0,o.jsx)(t.p,{children:"And that's it for this time! Next time we'll be looking at adding a GUI to the game so you can see how many presents you've collected!"})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},21756:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/files/DEC-PLAYHACK-TUT3-1-f9e6893cbd6fd0f07d9b8793048c3e48.png"},10487:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/files/DEC-PLAYHACK-TUT3-2-90ae97324e606544c7b873d56a33c12a.png"},36846:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/files/DEC-PLAYHACK-TUT3-3-9116aa4e82573576e63d10c1fa02d39a.png"},46398:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/DEC-PLAYHACK-TUT3-1-f9e6893cbd6fd0f07d9b8793048c3e48.png"},48501:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/DEC-PLAYHACK-TUT3-2-90ae97324e606544c7b873d56a33c12a.png"},65612:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/DEC-PLAYHACK-TUT3-3-9116aa4e82573576e63d10c1fa02d39a.png"},6694:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/playhack-logo-xmas-451ccd5e2d37685bc0f90e7e5a066b00.jpg"},28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>r});var o=n(96540);const s={},i=o.createContext(s);function a(e){const t=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),o.createElement(i.Provider,{value:t},e.children)}}}]);